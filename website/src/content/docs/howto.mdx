---
title: "How-To Guides"
description: "Deployment and configuration guides for Home Lab and Enterprise environments."
order: 2
---
import TieredTabs from '../../components/TieredTabs.astro';

/* ========================================================================
 * Project: pharos
 * Component: Marketing Site
 * File: howto.mdx
 * Author: Richard D. (https://github.com/iamrichardd)
 * License: AGPL-3.0 (See LICENSE file for details)
 * * Purpose (The "Why"):
 * Practical guides for deploying and using Pharos in various environments.
 * * Traceability:
 * Related to GitHub Issue #28, implements the documentation port to MDX.
 * Related to GitHub Issue #38, implements the tiered tabbed interface.
 * ======================================================================== */

Welcome to Project Pharos. These guides will help you transform your infrastructure from a static spreadsheet into a live, queryable source of truth.

## ‚ö°Ô∏è 3-Minute Quick Start: Your First Registry

Reach a success state in under 180 seconds. No installation required if you have Podman/Docker.

### 1. Launch the Pharos Ecosystem
Run the server and CLI tools in a single step using our demo environment.

```bash
# Start the Pharos Server in the background
podman run -d --name pharos-demo -p 1050:1050 -p 9090:9090 ghcr.io/iamrichardd/pharos:latest
```

### 2. See it in Action
Watch how easy it is to add and query your first infrastructure records:

![Pharos Quick Start Animation](/pharos/assets/quickstart.svg)

**Pro-Tip:** Use `mdb` for your machines and `ph` for your people. Pharos handles the protocol logic automatically.

---

## üõ°Ô∏è Security Tiers: Match Your Environment

<TieredTabs>
  <div slot="homelab">

    ## üè† Home Lab Tier: Restart-Survivable Storage

    For Home Lab environments (e.g., Proxmox LXC), Pharos provides a file-based storage engine that survives server restarts.

    ### Proxmox / LXC: 5-Minute Deployment

    This guide will help you set up Pharos as your infrastructure source of truth within a Proxmox LXC container.

    #### 1. Prepare the LXC Container
    Create an Ubuntu 24.04 LXC container. We recommend at least 512MB RAM and 2GB Disk.

    ```bash
    # Inside the LXC container
    apt-get update && apt-get install -y ca-certificates
    ```

    #### 2. Install the Pharos Server
    Download the latest `pharos-server` binary for `x86_64-unknown-linux-gnu`.

    ```bash
    wget https://github.com/iamrichardd/pharos/releases/download/v1.0.0/pharos-server-linux-x86_64
    chmod +x pharos-server-linux-x86_64
    mv pharos-server-linux-x86_64 /usr/local/bin/pharos-server
    ```

    #### 3. Configure Persistent Storage
    Create a directory for your data and set the environment variable.

    ```bash
    mkdir -p /var/lib/pharos
    export PHAROS_STORAGE_PATH="/var/lib/pharos/data.json"
    ```

    #### 4. Run as a Systemd Service
    For maximum reliability and uptime, run Pharos as a service so it's always available.

    ```bash
    cat <<EOF > /etc/systemd/system/pharos.service
    [Unit]
    Description=Pharos Infrastructure Server
    After=network.target

    [Service]
    ExecStart=/usr/local/bin/pharos-server
    Environment=PHAROS_STORAGE_PATH=/var/lib/pharos/data.json
    Environment=PHAROS_SECURITY_MODE=open
    Restart=always
    User=root

    [Install]
    WantedBy=multi-user.target
    EOF

    systemctl daemon-reload
    systemctl enable --now pharos
    ```

    #### 5. Verification
    Verify your server is responding to queries:

    ```bash
    telnet localhost 1050
    # Type: query name=test
    # You should receive a response
    ```

    ### ü©∫ Heartbeat Monitoring with `pharos-pulse`

    To monitor the health and configuration of your Home Lab nodes, deploy the `pharos-pulse` agent.

    1. **Install Pulse**:
       ```bash
       wget https://github.com/iamrichardd/pharos/releases/download/v1.2.1/pharos-pulse-linux-x86_musl
       chmod +x pharos-pulse-linux-x86_musl
       mv pharos-pulse-linux-x86_musl /usr/local/bin/pharos-pulse
       ```

    2. **Automatic Enrollment**:
       Generate a provisioning token from the Pharos Console and run the installer:
       ```bash
       # The token is short-lived and single-use
       pharos-pulse install --token <YOUR_PROVISIONING_TOKEN> --server <PHAROS_SERVER_IP>
       ```

    3. **Verify in Dashboard**:
       Open your Pharos Console. You should see the new node appearing in the "Pulse Monitor" view with real-time CPU/Memory telemetry.

  </div>

  <div slot="enterprise">

    ## üè¢ Enterprise Tier: LDAP & SSH Authentication

    Pharos integrates seamlessly with Enterprise infrastructure via LDAP backends and SSH-key authorization.

    ### 1. LDAP Integration
    Configure LDAP connection details:

    ```bash
    export PHAROS_LDAP_URL="ldap://ldap.enterprise.com:389"
    export PHAROS_LDAP_BIND_DN="cn=pharos,ou=services,dc=enterprise,dc=com"
    export PHAROS_LDAP_BIND_PW="secret"
    export PHAROS_LDAP_BASE_DN="dc=enterprise,dc=com"
    export PHAROS_SECURITY_MODE="scoped"
    ./pharos-server
    ```

    Pharos maps fields to standard object classes:
    - **People:** `inetOrgPerson` (maps `name` -> `cn`, `email` -> `mail`)
    - **Machines:** `ipHost` (maps `hostname` -> `cn`, `ip` -> `ipHostNumber`)

    ### 2. Multi-Tenant Node Monitoring

    In Enterprise environments, `pharos-pulse` uses the **Scoped** security model to ensure node telemetry is only visible to the appropriate teams.

    1. **Fleet Deployment**:
       Deploy `pharos-pulse` across your fleet using Ansible or Terraform. 

    2. **Security & Identity**:
       Pulse agents generate a unique SSH key pair locally. The public key is enrolled via the Pharos Console (or automated via WebMCP) and mapped to a `team_scope`.

    3. **Telemetry Access**:
       Only users belonging to the same `team_scope` in LDAP can query the telemetry for those specific nodes.

    ```bash
    # Example Ansible snippet for pharos-pulse deployment
    - name: Install pharos-pulse
      copy:
        src: files/pharos-pulse-linux-x86_musl
        dest: /usr/local/bin/pharos-pulse
        mode: '0755'
    
    - name: Register Pulse Service
      command: pharos-pulse install --server pharos.enterprise.com --team-scope engineering
    ```

    ### 3. SSH Authentication
    Secure your write operations by authorizing SSH keys.

    1.  **Server Setup:** Place authorized public keys in a directory.
        ```bash
        mkdir -p /etc/pharos/keys
        cp ~/.ssh/id_ed25519.pub /etc/pharos/keys/admin.pub
        export PHAROS_KEYS_DIR="/etc/pharos/keys"
        ```

    2.  **Client Setup:** The CLI clients will look for `~/.ssh/id_ed25519` by default.
        ```bash
        # Command will trigger challenge-response automatically
        ./ph add name="New User" email="user@enterprise.com"
        ```

    ### 4. DevSecOps Integration: Infrastructure as Code

    Pharos is designed for high-velocity DevSecOps teams. You can automate your infrastructure records by integrating Pharos into your CI/CD pipelines.

    #### 1. Configure the GitHub Actions / CI Server
    Securely store the SSH private key used for infrastructure updates.

    - **GitHub Secret:** `PHAROS_SSH_KEY`

    #### 2. Workflow Example: Automatic Infrastructure Updates
    Add a new machine record automatically after a successful build.

    ```yaml
    jobs:
      update-inventory:
        runs-on: ubuntu-latest
        steps:
          - uses: actions/checkout@v4
          - name: Deploy Pharos CLI
            run: |
              wget -q https://github.com/iamrichardd/pharos/releases/download/v1.0.0/mdb-linux-x86_64
              chmod +x mdb-linux-x86_64
              mv mdb-linux-x86_64 /usr/local/bin/mdb
          - name: Update Machine Record
            env:
              SSH_KEY: ${{ secrets.PHAROS_SSH_KEY }}
              PHAROS_SERVER: pharos.enterprise.com
            run: |
              mkdir -p ~/.ssh
              echo "$SSH_KEY" > ~/.ssh/id_ed25519
              chmod 600 ~/.ssh/id_ed25519
              mdb add hostname="web-app-v2" ip="${{ steps.deploy.outputs.ip }}" type="machine"
    ```

  </div>
</TieredTabs>

## üîç Network Discovery & Automation

Project Pharos includes `pharos-scan`, a powerful network discovery tool that automates the process of finding and provisioning your infrastructure.

### Using Pharos-Scan

The `pharos-scan` tool will browse your local network for services (like SSH, Proxmox, or Plex), probe their ports for fingerprinting, and check if they already exist in your Pharos inventory.

1.  **Run the Scanner:**
    ```bash
    ./pharos-scan
    ```

2.  **Interactive Selection:**
    Use the TUI to select the discovered nodes you want to provision.

3.  **Metadata Input:**
    The tool will prompt you for an alias and owner for each node before automatically adding them to the Pharos server using your authorized SSH key.

## üìä Monitoring

Pharos exposes Prometheus metrics on port `9090`.

- **Endpoint:** `http://localhost:9090/metrics`
- **Key Metrics:**
    - `pharos_cpu_usage_percentage`
    - `pharos_memory_usage_bytes`
    - `pharos_total_records`
