[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.12.8","content-config-digest","079f78274adbb711","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://iamrichardd.github.io\",\"compressHTML\":true,\"base\":\"/pharos/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_assets\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"prefetch\":{\"prefetchAll\":true,\"defaultStrategy\":\"viewport\"},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":\"shiki\",\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark-dimmed\",\"themes\":{},\"wrap\":true,\"transformers\":[]},\"remarkPlugins\":[null],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"rawEnvValues\":false},\"legacy\":{\"collections\":false}}","docs",["Map",11,12,22,23,32,33,42,43],"howto",{"id":11,"data":13,"body":17,"filePath":18,"digest":19,"legacyId":20,"deferredRender":21},{"title":14,"description":15,"order":16},"How-To Guides","Deployment and configuration guides for Home Lab and Enterprise environments.",2,"import TieredTabs from '../../components/TieredTabs.astro';\n\n/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: howto.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Practical guides for deploying and using Pharos in various environments.\n * * Traceability:\n * Related to GitHub Issue #28, implements the documentation port to MDX.\n * Related to GitHub Issue #38, implements the tiered tabbed interface.\n * ======================================================================== */\n\nWelcome to Project Pharos. These guides will help you get started whether you are a Home Labber or an Enterprise Engineer.\n\n\u003CTieredTabs>\n  \u003Cdiv slot=\"homelab\">\n\n    ## üè† Home Lab Tier: Restart-Survivable Storage\n\n    For Home Lab environments (e.g., Proxmox LXC), Pharos provides a file-based storage engine that survives server restarts.\n\n    ### Proxmox / LXC: 5-Minute Deployment\n\n    This guide will help you set up Pharos as your infrastructure source of truth within a Proxmox LXC container.\n\n    #### 1. Prepare the LXC Container\n    Create an Ubuntu 24.04 LXC container. We recommend at least 512MB RAM and 2GB Disk.\n\n    ```bash\n    # Inside the LXC container\n    apt-get update && apt-get install -y ca-certificates\n    ```\n\n    #### 2. Install the Pharos Server\n    Download the latest `pharos-server` binary for `x86_64-unknown-linux-gnu`.\n\n    ```bash\n    wget https://github.com/iamrichardd/pharos/releases/download/v1.0.0/pharos-server-linux-x86_64\n    chmod +x pharos-server-linux-x86_64\n    mv pharos-server-linux-x86_64 /usr/local/bin/pharos-server\n    ```\n\n    #### 3. Configure Persistent Storage\n    Create a directory for your data and set the environment variable.\n\n    ```bash\n    mkdir -p /var/lib/pharos\n    export PHAROS_STORAGE_PATH=\"/var/lib/pharos/data.json\"\n    ```\n\n    #### 4. Run as a Systemd Service\n    To make your Home Lab truly badass, run Pharos as a service so it's always available.\n\n    ```bash\n    cat \u003C\u003CEOF > /etc/systemd/system/pharos.service\n    [Unit]\n    Description=Pharos Infrastructure Server\n    After=network.target\n\n    [Service]\n    ExecStart=/usr/local/bin/pharos-server\n    Environment=PHAROS_STORAGE_PATH=/var/lib/pharos/data.json\n    Restart=always\n    User=root\n\n    [Install]\n    WantedBy=multi-user.target\n    EOF\n\n    systemctl daemon-reload\n    systemctl enable --now pharos\n    ```\n\n    #### 5. Verification\n    Verify your server is responding to queries:\n\n    ```bash\n    telnet localhost 1050\n    # Type: query name=test\n    # You should receive a response\n    ```\n\n    ### 1. Configuration\n    Set the `PHAROS_STORAGE_PATH` environment variable to point to your data file.\n\n    ```bash\n    export PHAROS_STORAGE_PATH=\"/var/lib/pharos/data.json\"\n    ./pharos-server\n    ```\n\n    ### 2. Record Management\n    Add a new contact using the `ph` CLI:\n\n    ```bash\n    # Add a person\n    ./ph add name=\"John Doe\" email=\"john@home.lab\" type=\"person\"\n\n    # Add a machine (using mdb)\n    ./mdb add hostname=\"srv-01\" ip=\"192.168.1.10\" type=\"machine\"\n    ```\n\n  \u003C/div>\n\n  \u003Cdiv slot=\"enterprise\">\n\n    ## üè¢ Enterprise Tier: LDAP & SSH Authentication\n\n    Pharos integrates seamlessly with Enterprise infrastructure via LDAP backends and SSH-key authorization.\n\n    ### 1. LDAP Integration\n    Configure LDAP connection details:\n\n    ```bash\n    export PHAROS_LDAP_URL=\"ldap://ldap.enterprise.com:389\"\n    export PHAROS_LDAP_BIND_DN=\"cn=pharos,ou=services,dc=enterprise,dc=com\"\n    export PHAROS_LDAP_BIND_PW=\"secret\"\n    export PHAROS_LDAP_BASE_DN=\"dc=enterprise,dc=com\"\n    ./pharos-server\n    ```\n\n    Pharos maps fields to standard object classes:\n    - **People:** `inetOrgPerson` (maps `name` -> `cn`, `email` -> `mail`)\n    - **Machines:** `ipHost` (maps `hostname` -> `cn`, `ip` -> `ipHostNumber`)\n\n    ### 2. SSH Authentication\n    Secure your write operations by authorizing SSH keys.\n\n    1.  **Server Setup:** Place authorized public keys in a directory.\n        ```bash\n        mkdir -p /etc/pharos/keys\n        cp ~/.ssh/id_ed25519.pub /etc/pharos/keys/admin.pub\n        export PHAROS_KEYS_DIR=\"/etc/pharos/keys\"\n        ```\n\n    2.  **Client Setup:** The CLI clients will look for `~/.ssh/id_ed25519` by default.\n        ```bash\n        # Command will trigger challenge-response automatically\n        ./ph add name=\"New User\" email=\"user@enterprise.com\"\n        ```\n\n    ### 3. DevSecOps Integration: Infrastructure as Code\n\n    Pharos is designed for high-velocity DevSecOps teams. You can automate your infrastructure records by integrating Pharos into your CI/CD pipelines.\n\n    #### 1. Configure the GitHub Actions / CI Server\n    Securely store the SSH private key used for infrastructure updates.\n\n    - **GitHub Secret:** `PHAROS_SSH_KEY`\n\n    #### 2. Workflow Example: Automatic Infrastructure Updates\n    Add a new machine record automatically after a successful build.\n\n    ```yaml\n    jobs:\n      update-inventory:\n        runs-on: ubuntu-latest\n        steps:\n          - uses: actions/checkout@v4\n          - name: Deploy Pharos CLI\n            run: |\n              wget -q https://github.com/iamrichardd/pharos/releases/download/v1.0.0/mdb-linux-x86_64\n              chmod +x mdb-linux-x86_64\n              mv mdb-linux-x86_64 /usr/local/bin/mdb\n          - name: Update Machine Record\n            env:\n              SSH_KEY: ${{ secrets.PHAROS_SSH_KEY }}\n              PHAROS_SERVER: pharos.enterprise.com\n            run: |\n              mkdir -p ~/.ssh\n              echo \"$SSH_KEY\" > ~/.ssh/id_ed25519\n              chmod 600 ~/.ssh/id_ed25519\n              mdb add hostname=\"web-app-v2\" ip=\"${{ steps.deploy.outputs.ip }}\" type=\"machine\"\n    ```\n\n  \u003C/div>\n\u003C/TieredTabs>\n\n## üìä Monitoring\n\nPharos exposes Prometheus metrics on port `9090`.\n\n- **Endpoint:** `http://localhost:9090/metrics`\n- **Key Metrics:**\n    - `pharos_cpu_usage_percentage`\n    - `pharos_memory_usage_bytes`\n    - `pharos_total_records`","src/content/docs/howto.mdx","6c76a0257ea602d5","howto.mdx",true,"architecture",{"id":22,"data":24,"body":28,"filePath":29,"digest":30,"legacyId":31,"deferredRender":21},{"title":25,"description":26,"order":27},"Architecture","High-level overview of the Pharos system design, storage tiering, and protocol.",1,"/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: architecture.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Detailed architectural overview of the Pharos ecosystem.\n * * Traceability:\n * Related to GitHub Issue #28, implements the documentation port to MDX.\n * ======================================================================== */\n\nProject Pharos is a highly performant, read-optimized client-server ecosystem based on RFC 2378 (Phonebook Protocol).\n\n## System Overview\n\nThe following diagram illustrates the high-level architecture of Pharos, showing the interaction between CLI clients and the server components.\n\n```mermaid\ngraph TD\n    subgraph Clients\n        PH[ph CLI - People]\n        MDB[mdb CLI - Machines]\n    end\n\n    subgraph \"Pharos Server\"\n        TCP[TCP Listener :1050]\n        Parser[RFC 2378 Parser]\n        Auth[Auth Manager - SSH Keys]\n        Metrics[Metrics Engine - Prometheus]\n        StorageTrait[Storage Trait]\n        \n        subgraph \"Storage Backends\"\n            Mem[MemoryStorage - Dev]\n            File[FileStorage - Home Lab]\n            LDAP[LdapStorage - Enterprise]\n        end\n    end\n\n    PH -->|RFC 2378| TCP\n    MDB -->|RFC 2378| TCP\n    TCP --> Parser\n    Parser --> Auth\n    Auth --> StorageTrait\n    StorageTrait --> Mem\n    StorageTrait --> File\n    StorageTrait --> LDAP\n    \n    Metrics -.->|Observe| StorageTrait\n    Metrics -.->|Observe| TCP\n```\n\n## Storage Tiering Logic\n\nPharos uses a tiered storage approach to cater to different deployment environments, from volatile development instances to persistent enterprise-grade directory services.\n\n```mermaid\ngraph LR\n    subgraph \"Tier 1: Development\"\n        Mem[MemoryStorage]\n        Mem -.->|Volatile| Data((In-Memory))\n    end\n\n    subgraph \"Tier 2: Home Lab\"\n        File[FileStorage]\n        File -.->|Persistent| JSON[(Local JSON File)]\n    end\n\n    subgraph \"Tier 3: Enterprise\"\n        LDAP[LdapStorage]\n        LDAP -.->|Centralized| Directory[(LDAP Server)]\n    end\n```\n\n## Core Protocol: RFC 2378 (Modified)\n\nPharos implements the Phonebook Protocol with extensions for modern infrastructure management and secure authentication.\n\n### Message Flow\n1. **QUERY:** Client sends a search string.\n2. **DISCRIMINATE:** Server identifies if the target is a `person` or `machine`.\n3. **AUTH (if Write):** Server issues an SSH challenge. Client signs and returns.\n4. **RESPONSE:** Server returns records in Ph format.\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant Server\n    participant Auth\n    participant Storage\n\n    Client->>Server: QUERY \"name=John\"\n    Server->>Storage: Search(people, \"John\")\n    Storage-->>Server: [Records]\n    Server-->>Client: 200: [Ph Records]\n\n    Note over Client,Server: Write Operation\n    Client->>Server: ADD \"name=Jane\"\n    Server->>Auth: Challenge(SSH-Key)\n    Auth-->>Client: Challenge\n    Client-->>Auth: Signed-Response\n    Auth-->>Server: Verified\n    Server->>Storage: Commit(Jane)\n    Server-->>Client: 200: Success\n```\n\n## Core Components\n\n### 1. Pharos Server (`pharos-server`)\nThe backend engine handling connection lifecycle, protocol parsing, and storage abstraction.\n- **Protocol:** RFC 2378 (Ph) with `auth` extension.\n- **Authentication:** SSH-key based challenge-response for Write operations.\n- **Metrics:** Integrated Prometheus scrape point (`:9090/metrics`) and health monitoring.\n\n### 2. CLI Clients\n- **`ph`:** Optimized for human contact management.\n- **`mdb`:** Optimized for machine/infrastructure asset management.\n- Both support automatic authentication via local SSH private keys.\n\n### 3. Storage Tiering\n- **Development:** Zero-configuration in-memory storage.\n- **Home Lab:** File-level, restart-survivable JSON storage (optimized for LXC).\n- **Enterprise:** LDAP-backed storage utilizing standard schemas (`inetOrgPerson`, `ipHost`).","src/content/docs/architecture.mdx","d2f0d4cc7f6bfa16","architecture.mdx","integrations",{"id":32,"data":34,"body":38,"filePath":39,"digest":40,"legacyId":41,"deferredRender":21},{"title":35,"description":36,"order":37},"Integrations","How to integrate Project Pharos into your existing Home Lab or Enterprise infrastructure.",4,"/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: integrations.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Deep-dive guides for integrating Pharos with external systems.\n * * Traceability:\n * Related to GitHub Issue #34, expands the documentation.\n * ======================================================================== */\n\nProject Pharos is designed to be the backbone of your infrastructure data. This guide will walk you through building deep integrations using the middleware system and CLI clients.\n\n---\n\n## üèóÔ∏è Proxmox Hooks (Home Lab)\n\nMaking your Home Lab \"badass\" means zero manual data entry. You can automate the registration of your LXC containers and VMs directly into Pharos using Proxmox hook scripts.\n\n### 1. Create the Hook Script\nCreate a shell script on your Proxmox host (`/usr/local/bin/pharos-hook.sh`).\n\n```bash\n#!/bin/bash\n\n# Proxmox hook script to register new containers in Pharos\n# Usage: ./pharos-hook.sh \u003Cvmid> \u003Cphase>\n\nVMID=$1\nPHASE=$2\n\nif [ \"$PHASE\" == \"post-start\" ]; then\n    # Get the hostname and IP of the container\n    HOSTNAME=$(pct exec $VMID -- hostname)\n    IP=$(pct exec $VMID -- hostname -I | awk '{print $1}')\n    \n    # Register with Pharos mdb\n    mdb add hostname=\"$HOSTNAME\" ip=\"$IP\" type=\"machine\" vmid=\"$VMID\" status=\"up\"\nfi\n\nif [ \"$PHASE\" == \"pre-stop\" ]; then\n    # Update status to down\n    HOSTNAME=$(pct exec $VMID -- hostname)\n    mdb update hostname=\"$HOSTNAME\" status=\"down\"\nfi\n```\n\n### 2. Configure the Hook in Proxmox\nEdit the container configuration (`/etc/pve/lxc/\u003Cvmid>.conf`) to use the hook script.\n\n```text\nhookscript: local:snippets/pharos-hook.sh\n```\n\n---\n\n## üèõÔ∏è Enterprise LDAP Sync\n\nPharos isn't just a standalone directory; it's a high-speed cache and query layer for your Enterprise LDAP.\n\n### 1. Field Mapping\nPharos allows you to map internal fields to standard LDAP object classes.\n\n| Pharos Field | LDAP Attribute | Object Class |\n| :--- | :--- | :--- |\n| `name` | `cn` | `inetOrgPerson` |\n| `email` | `mail` | `inetOrgPerson` |\n| `hostname` | `cn` | `ipHost` |\n| `ip` | `ipHostNumber` | `ipHost` |\n\n### 2. Performance Tuning\nWhen using the LDAP backend, Pharos automatically implements a TTL-based cache.\n\n- **`PHAROS_LDAP_CACHE_TTL`**: Default 300s. Adjust this based on your network reliability and read requirements.\n\n---\n\n## üîå Custom Middleware & Hooks\n\nFor advanced users, Pharos Server supports a middleware system that allows you to intercept and process requests.\n\n### Use Case: Slack Notifications on Write\nYou can write a simple middleware that sends a Slack notification whenever a record is added or updated.\n\n```rust\n// Example middleware logic (pseudocode)\npub struct SlackNotificationMiddleware;\n\nimpl Middleware for SlackNotificationMiddleware {\n    fn on_request(&self, request: &Request) {\n        if request.command == Command::Add || request.command == Command::Update {\n            let message = format!(\"Record updated: {}\", request.payload);\n            send_to_slack(message);\n        }\n    }\n}\n```\n\nTo enable custom middleware, you must rebuild `pharos-server` with your module included in `src/middleware.rs`.\n\n---\n\n## üõ†Ô∏è Ansible Integration\n\nKeep your Ansible inventory in sync with Pharos using a dynamic inventory script.\n\n### Dynamic Inventory Example (Python)\nSave this as `pharos_inventory.py` and use it with `ansible-inventory`.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport subprocess\n\ndef get_inventory():\n    # Call the mdb CLI to get all machine records\n    result = subprocess.run(['mdb', 'query', 'type=machine'], capture_output=True, text=True)\n    records = json.loads(result.stdout)\n    \n    inventory = {\n        'all': {\n            'hosts': [r['hostname'] for r in records],\n            'vars': {}\n        },\n        '_meta': {\n            'hostvars': {r['hostname']: {'ansible_host': r['ip']} for r in records}\n        }\n    }\n    return inventory\n\nif __name__ == \"__main__\":\n    print(json.dumps(get_inventory()))\n```\n\n---\n\n### Need Help?\nBuilding a custom integration? Check out our [Architecture Overview](/docs/architecture) or join our [Community Discussion](https://github.com/iamrichardd/pharos/discussions).","src/content/docs/integrations.mdx","7489751374662ec2","integrations.mdx","showcase",{"id":42,"data":44,"body":48,"filePath":49,"digest":50,"legacyId":51,"deferredRender":21},{"title":45,"description":46,"order":47},"Showcase","See how Home Labbers and Enterprise Engineers are using Pharos to build badass systems.",3,"/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: showcase.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Showcase real-world applications of Pharos to inspire and guide users.\n * * Traceability:\n * Related to GitHub Issue #34, expands the documentation.\n * ======================================================================== */\n\nProject Pharos is more than just a protocol; it's a foundation for building high-performance, read-optimized infrastructure. Here's how our community is making a difference.\n\n## üè† The Home Lab: Automated LXC Inventory\n\n**User:** `@homelab-hero`\n**Environment:** Proxmox VE, 12 LXC Containers\n\n### The Challenge\nManaging static IP addresses and hostnames across a dozen LXC containers was becoming a manual nightmare. The user needed a single source of truth that was lightweight enough to run on a Raspberry Pi 4.\n\n### The Pharos Solution\nBy deploying Pharos as a central registry, the user integrated a custom `post-provisioning` script in Proxmox.\n\n- **Automation:** Every time a new LXC is created, a hook calls `mdb add` to register the new machine.\n- **Discovery:** Other containers use `mdb query` to find the IP of the database or monitoring server.\n\n> \"Pharos turned my messy spreadsheet into a live, queryable API. It's the DNS that actually tells me what my infrastructure looks like.\" ‚Äî `@homelab-hero`\n\n---\n\n## üè¢ Enterprise: DevSecOps \"Write-Once\" Infrastructure\n\n**User:** Global Logistics Corp (Infrastructure Team)\n**Environment:** Hybrid Cloud, Kubernetes, LDAP\n\n### The Challenge\nThe security team required strict attribution for all infrastructure changes. They needed a way to update the global phonebook that didn't involve sharing passwords or managing complex IAM policies for simple metadata.\n\n### The Pharos Solution\nPharos was deployed with the **Enterprise Tier** (LDAP backend) and **SSH-key authentication**.\n\n- **Attribution:** Every update is signed by an engineer's existing SSH key. No new passwords to manage.\n- **Consistency:** Pharos syncs directly to the corporate LDAP, ensuring the \"People\" and \"Machine\" directories are always in lockstep.\n- **Speed:** With 90% read traffic, the sub-millisecond response time of Pharos outperformed their legacy LDAP queries for common lookups.\n\n---\n\n## üöÄ The \"Badass\" Use Case: Edge Node Discovery\n\n**User:** Open-Source IoT Project\n**Environment:** 500+ Edge Gateways\n\n### The Challenge\nEdge devices behind NAT needed a way to register their public-facing IP and health status to a central coordinator without the overhead of a full service mesh.\n\n### The Pharos Solution\nThey used the **Pharos Middleware System** to implement a custom hook that validates edge node certificates before allowing a registration.\n\n- **Minimal Footprint:** The `ph` CLI was cross-compiled for `aarch64` and deployed as a 2MB binary on every edge node.\n- **Resilience:** The nodes heartbeat their status into Pharos, and the dashboard queries Pharos to visualize the entire network in real-time.\n\n---\n\n### Have a story to share?\nWe want to see how you're using Pharos to build something awesome. [Open a Pull Request](https://github.com/iamrichardd/pharos/pulls) or share your setup on the community forums!","src/content/docs/showcase.mdx","82c6e8ed15aea667","showcase.mdx"]