[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.12.8","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://iamrichardd.github.io\",\"compressHTML\":true,\"base\":\"/pharos/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_assets\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"prefetch\":{\"prefetchAll\":true,\"defaultStrategy\":\"viewport\"},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":\"shiki\",\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark-dimmed\",\"themes\":{},\"wrap\":true,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"rawEnvValues\":false},\"legacy\":{\"collections\":false}}","content-config-digest","079f78274adbb711","docs",["Map",11,12,22,23],"architecture",{"id":11,"data":13,"body":17,"filePath":18,"digest":19,"legacyId":20,"deferredRender":21},{"title":14,"description":15,"order":16},"Pharos Architecture","High-level overview of the Pharos system design, storage tiering, and protocol.",1,"/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: architecture.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Detailed architectural overview of the Pharos ecosystem.\n * * Traceability:\n * Related to GitHub Issue #28, implements the documentation port to MDX.\n * ======================================================================== */\n\nProject Pharos is a highly performant, read-optimized client-server ecosystem based on RFC 2378 (Phonebook Protocol).\n\n## System Overview\n\nThe following diagram illustrates the high-level architecture of Pharos, showing the interaction between CLI clients and the server components.\n\n```mermaid\ngraph TD\n    subgraph Clients\n        PH[ph CLI - People]\n        MDB[mdb CLI - Machines]\n    end\n\n    subgraph \"Pharos Server\"\n        TCP[TCP Listener :1050]\n        Parser[RFC 2378 Parser]\n        Auth[Auth Manager - SSH Keys]\n        Metrics[Metrics Engine - Prometheus]\n        StorageTrait[Storage Trait]\n        \n        subgraph \"Storage Backends\"\n            Mem[MemoryStorage - Dev]\n            File[FileStorage - Home Lab]\n            LDAP[LdapStorage - Enterprise]\n        end\n    end\n\n    PH -->|RFC 2378| TCP\n    MDB -->|RFC 2378| TCP\n    TCP --> Parser\n    Parser --> Auth\n    Auth --> StorageTrait\n    StorageTrait --> Mem\n    StorageTrait --> File\n    StorageTrait --> LDAP\n    \n    Metrics -.->|Observe| StorageTrait\n    Metrics -.->|Observe| TCP\n```\n\n## Storage Tiering Logic\n\nPharos uses a tiered storage approach to cater to different deployment environments, from volatile development instances to persistent enterprise-grade directory services.\n\n```mermaid\ngraph LR\n    subgraph \"Tier 1: Development\"\n        Mem[MemoryStorage]\n        Mem -.->|Volatile| Data((In-Memory))\n    end\n\n    subgraph \"Tier 2: Home Lab\"\n        File[FileStorage]\n        File -.->|Persistent| JSON[(Local JSON File)]\n    end\n\n    subgraph \"Tier 3: Enterprise\"\n        LDAP[LdapStorage]\n        LDAP -.->|Centralized| Directory[(LDAP Server)]\n    end\n```\n\n## Core Protocol: RFC 2378 (Modified)\n\nPharos implements the Phonebook Protocol with extensions for modern infrastructure management and secure authentication.\n\n### Message Flow\n1. **QUERY:** Client sends a search string.\n2. **DISCRIMINATE:** Server identifies if the target is a `person` or `machine`.\n3. **AUTH (if Write):** Server issues an SSH challenge. Client signs and returns.\n4. **RESPONSE:** Server returns records in Ph format.\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant Server\n    participant Auth\n    participant Storage\n\n    Client->>Server: QUERY \"name=John\"\n    Server->>Storage: Search(people, \"John\")\n    Storage-->>Server: [Records]\n    Server-->>Client: 200: [Ph Records]\n\n    Note over Client,Server: Write Operation\n    Client->>Server: ADD \"name=Jane\"\n    Server->>Auth: Challenge(SSH-Key)\n    Auth-->>Client: Challenge\n    Client-->>Auth: Signed-Response\n    Auth-->>Server: Verified\n    Server->>Storage: Commit(Jane)\n    Server-->>Client: 200: Success\n```\n\n## Core Components\n\n### 1. Pharos Server (`pharos-server`)\nThe backend engine handling connection lifecycle, protocol parsing, and storage abstraction.\n- **Protocol:** RFC 2378 (Ph) with `auth` extension.\n- **Authentication:** SSH-key based challenge-response for Write operations.\n- **Metrics:** Integrated Prometheus scrape point (`:9090/metrics`) and health monitoring.\n\n### 2. CLI Clients\n- **`ph`:** Optimized for human contact management.\n- **`mdb`:** Optimized for machine/infrastructure asset management.\n- Both support automatic authentication via local SSH private keys.\n\n### 3. Storage Tiering\n- **Development:** Zero-configuration in-memory storage.\n- **Home Lab:** File-level, restart-survivable JSON storage (optimized for LXC).\n- **Enterprise:** LDAP-backed storage utilizing standard schemas (`inetOrgPerson`, `ipHost`).","src/content/docs/architecture.mdx","0099346468de4db2","architecture.mdx",true,"howto",{"id":22,"data":24,"body":28,"filePath":29,"digest":30,"legacyId":31,"deferredRender":21},{"title":25,"description":26,"order":27},"Pharos How-To Guides","Deployment and configuration guides for Home Lab and Enterprise environments.",2,"/* ========================================================================\n * Project: pharos\n * Component: Marketing Site\n * File: howto.mdx\n * Author: Richard D. (https://github.com/iamrichardd)\n * License: AGPL-3.0 (See LICENSE file for details)\n * * Purpose (The \"Why\"):\n * Practical guides for deploying and using Pharos in various environments.\n * * Traceability:\n * Related to GitHub Issue #28, implements the documentation port to MDX.\n * ======================================================================== */\n\nWelcome to Project Pharos. These guides will help you get started whether you are a Home Labber or an Enterprise Engineer.\n\n## ðŸ  Home Lab Tier: Restart-Survivable Storage\n\nFor Home Lab environments (e.g., Proxmox LXC), Pharos provides a file-based storage engine that survives server restarts.\n\n### Proxmox / LXC: 5-Minute Deployment\n\nThis guide will help you set up Pharos as your infrastructure source of truth within a Proxmox LXC container.\n\n#### 1. Prepare the LXC Container\nCreate an Ubuntu 24.04 LXC container. We recommend at least 512MB RAM and 2GB Disk.\n\n```bash\n# Inside the LXC container\napt-get update && apt-get install -y ca-certificates\n```\n\n#### 2. Install the Pharos Server\nDownload the latest `pharos-server` binary for `x86_64-unknown-linux-gnu`.\n\n```bash\nwget https://github.com/iamrichardd/pharos/releases/download/v1.0.0/pharos-server-linux-x86_64\nchmod +x pharos-server-linux-x86_64\nmv pharos-server-linux-x86_64 /usr/local/bin/pharos-server\n```\n\n#### 3. Configure Persistent Storage\nCreate a directory for your data and set the environment variable.\n\n```bash\nmkdir -p /var/lib/pharos\nexport PHAROS_STORAGE_PATH=\"/var/lib/pharos/data.json\"\n```\n\n#### 4. Run as a Systemd Service\nTo make your Home Lab truly badass, run Pharos as a service so it's always available.\n\n```bash\ncat \u003C\u003CEOF > /etc/systemd/system/pharos.service\n[Unit]\nDescription=Pharos Infrastructure Server\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/pharos-server\nEnvironment=PHAROS_STORAGE_PATH=/var/lib/pharos/data.json\nRestart=always\nUser=root\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsystemctl daemon-reload\nsystemctl enable --now pharos\n```\n\n#### 5. Verification\nVerify your server is responding to queries:\n\n```bash\ntelnet localhost 1050\n# Type: query name=test\n# You should receive a response\n```\n\n### 1. Configuration\nSet the `PHAROS_STORAGE_PATH` environment variable to point to your data file.\n\n```bash\nexport PHAROS_STORAGE_PATH=\"/var/lib/pharos/data.json\"\n./pharos-server\n```\n\n### 2. Record Management\nAdd a new contact using the `ph` CLI:\n\n```bash\n# Add a person\n./ph add name=\"John Doe\" email=\"john@home.lab\" type=\"person\"\n\n# Add a machine (using mdb)\n./mdb add hostname=\"srv-01\" ip=\"192.168.1.10\" type=\"machine\"\n```\n\n## ðŸ¢ Enterprise Tier: LDAP & SSH Authentication\n\nPharos integrates seamlessly with Enterprise infrastructure via LDAP backends and SSH-key authorization.\n\n### 1. LDAP Integration\nConfigure LDAP connection details:\n\n```bash\nexport PHAROS_LDAP_URL=\"ldap://ldap.enterprise.com:389\"\nexport PHAROS_LDAP_BIND_DN=\"cn=pharos,ou=services,dc=enterprise,dc=com\"\nexport PHAROS_LDAP_BIND_PW=\"secret\"\nexport PHAROS_LDAP_BASE_DN=\"dc=enterprise,dc=com\"\n./pharos-server\n```\n\nPharos maps fields to standard object classes:\n- **People:** `inetOrgPerson` (maps `name` -> `cn`, `email` -> `mail`)\n- **Machines:** `ipHost` (maps `hostname` -> `cn`, `ip` -> `ipHostNumber`)\n\n### 2. SSH Authentication\nSecure your write operations by authorizing SSH keys.\n\n1.  **Server Setup:** Place authorized public keys in a directory.\n    ```bash\n    mkdir -p /etc/pharos/keys\n    cp ~/.ssh/id_ed25519.pub /etc/pharos/keys/admin.pub\n    export PHAROS_KEYS_DIR=\"/etc/pharos/keys\"\n    ```\n\n2.  **Client Setup:** The CLI clients will look for `~/.ssh/id_ed25519` by default.\n    ```bash\n    # Command will trigger challenge-response automatically\n    ./ph add name=\"New User\" email=\"user@enterprise.com\"\n    ```\n\n### 3. DevSecOps Integration: Infrastructure as Code\n\nPharos is designed for high-velocity DevSecOps teams. You can automate your infrastructure records by integrating Pharos into your CI/CD pipelines.\n\n#### 1. Configure the GitHub Actions / CI Server\nSecurely store the SSH private key used for infrastructure updates.\n\n- **GitHub Secret:** `PHAROS_SSH_KEY`\n\n#### 2. Workflow Example: Automatic Infrastructure Updates\nAdd a new machine record automatically after a successful build.\n\n```yaml\njobs:\n  update-inventory:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - name: Deploy Pharos CLI\n        run: |\n          wget -q https://github.com/iamrichardd/pharos/releases/download/v1.0.0/mdb-linux-x86_64\n          chmod +x mdb-linux-x86_64\n          mv mdb-linux-x86_64 /usr/local/bin/mdb\n      - name: Update Machine Record\n        env:\n          SSH_KEY: ${{ secrets.PHAROS_SSH_KEY }}\n          PHAROS_SERVER: pharos.enterprise.com\n        run: |\n          mkdir -p ~/.ssh\n          echo \"$SSH_KEY\" > ~/.ssh/id_ed25519\n          chmod 600 ~/.ssh/id_ed25519\n          mdb add hostname=\"web-app-v2\" ip=\"${{ steps.deploy.outputs.ip }}\" type=\"machine\"\n```\n\n## ðŸ“Š Monitoring\n\nPharos exposes Prometheus metrics on port `9090`.\n\n- **Endpoint:** `http://localhost:9090/metrics`\n- **Key Metrics:**\n    - `pharos_cpu_usage_percentage`\n    - `pharos_memory_usage_bytes`\n    - `pharos_total_records`","src/content/docs/howto.mdx","ea60803d8beeb537","howto.mdx"]